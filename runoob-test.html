<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>花绽放效果</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            overflow: hidden;
        }

        canvas {
            position: absolute;
            top: 50%;
            left: 50%;
/*             transform: translate(-50%, -50%); /* 居中 */ */
        }
    </style>
</head>
<body>
    <canvas id="c"></canvas>
    <script>
        var b = document.body;
        var c = document.getElementById('c');
        var a = c.getContext('2d');

        // 设置画布尺寸自适应屏幕大小
        c.width = window.innerWidth;
        c.height = window.innerHeight;

        var m = Math;
        var C = m.cos;
        var S = m.sin;
        var P = m.pow;
        var R = m.random;

        var f = 600;
        var h = -250;

        // 花的基本参数
        var flower = {
            x: c.width / 2,
            y: c.height / 2,
            petalCount: 8,
            petalLength: 120,
            petalWidth: 30,
            color: "#FF69B4"
        };

        // 光辉粒子数组
        var particles = [];

        // 绘制花朵
        function drawFlower() {
            a.save();
            a.translate(flower.x, flower.y);
            a.beginPath();

            for (var i = 0; i < flower.petalCount; i++) {
                var angle = (i * Math.PI * 2) / flower.petalCount;
                var petalX = flower.petalLength * Math.cos(angle);
                var petalY = flower.petalLength * Math.sin(angle);

                // 绘制每一片花瓣
                a.moveTo(0, 0);
                a.lineTo(petalX, petalY);
                a.lineWidth = flower.petalWidth;
                a.strokeStyle = flower.color;
                a.stroke();
            }

            a.restore();
        }

        // 创建光辉粒子
        function createParticle() {
            var angle = Math.random() * Math.PI * 2;
            var distance = Math.random() * 200 + 50; // 粒子离花朵的初始距离
            var speed = Math.random() * 3 + 1; // 粒子的速度
            var particle = {
                x: flower.x + Math.cos(angle) * distance,
                y: flower.y + Math.sin(angle) * distance,
                radius: Math.random() * 2 + 1,
                alpha: 1,
                speed: speed,
                angle: angle
            };
            particles.push(particle);
        }

        // 绘制光辉粒子
        function drawParticles() {
            a.globalCompositeOperation = 'lighter'; // 光辉效果
            for (var i = 0; i < particles.length; i++) {
                var p = particles[i];
                a.beginPath();
                a.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
                a.fillStyle = "rgba(255, 255, 255, " + p.alpha + ")";
                a.fill();
                a.closePath();

                // 更新粒子位置和透明度
                p.x += Math.cos(p.angle) * p.speed;
                p.y += Math.sin(p.angle) * p.speed;
                p.alpha -= 0.01;
                p.radius += 0.05;

                // 移除过时的粒子
                if (p.alpha <= 0) {
                    particles.splice(i, 1);
                    i--;
                }
            }
            a.globalCompositeOperation = 'source-over'; // 恢复正常合成模式
        }

        // 动画函数
        function animate() {
            a.clearRect(0, 0, c.width, c.height); // 清空画布

            // 绘制花朵
            drawFlower();

            // 创建新的光辉粒子
            if (Math.random() < 0.1) { // 每帧产生光辉粒子
                createParticle();
            }

            // 绘制并更新粒子
            drawParticles();

            requestAnimationFrame(animate); // 持续调用动画函数
        }

        // 启动动画
        animate();

        // 窗口调整时，重新设置画布尺寸
        window.onresize = function () {
            c.width = window.innerWidth;
            c.height = window.innerHeight;
        };
    </script>
</body>
</html>
